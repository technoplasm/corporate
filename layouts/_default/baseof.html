<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.9">
    <meta name="view-transition" content="same-origin">
    <title>{{ block "title" . }}{{ .Site.Title }}{{ end }}</title>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link rel="icon" href="/favicon.png" type="image/png">

    <!-- OGP -->
    <meta property="og:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}">
    <meta property="og:description" content="{{ with .Params.description }}{{ . }}{{ else }}{{ with .Summary }}{{ . | plainify | truncate 120 }}{{ else }}{{ .Site.Params.description }}{{ end }}{{ end }}">
    <meta property="og:type" content="{{ if .IsHome }}website{{ else }}article{{ end }}">
    <meta property="og:url" content="{{ .Permalink }}">
    {{ with .Params.image }}<meta property="og:image" content="{{ . | absURL }}">{{ end }}
    <meta property="og:site_name" content="{{ .Site.Title }}">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}">
    <meta name="twitter:description" content="{{ with .Params.description }}{{ . }}{{ else }}{{ with .Summary }}{{ . | plainify | truncate 120 }}{{ else }}{{ .Site.Params.description }}{{ end }}{{ end }}">
    {{ with .Params.image }}<meta name="twitter:image" content="{{ . | absURL }}">{{ end }}
    {{ with (templates.Defer (dict "key" "global")) }}
    {{ $css := resources.Get "css/main.css" | css.PostCSS }}
    {{ if hugo.IsProduction }}
        {{ $css = $css | fingerprint }}
    {{ end }}
    <link rel="stylesheet" href="{{ $css.RelPermalink }}">
    {{ end }}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
        }
        .font-public-sans {
            font-family: 'Public Sans', sans-serif;
        }

        .text-stencil {
            background: #64748b;
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: none;
        }
    </style>
    <style>
        .gradient-overlay {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 0;
            opacity: 0.15;
            animation: gradientShift 30s ease-in-out infinite;
        }
        @keyframes gradientShift {
            0%, 100% { background: linear-gradient(135deg, #a090c0 0%, #c0a0b0 100%); }
            33% { background: linear-gradient(135deg, #c0a0b0 0%, #90a0c0 100%); }
            66% { background: linear-gradient(135deg, #90a0c0 0%, #a090c0 100%); }
        }
        .particles {
            position: fixed;
            inset: 0;
            overflow: hidden;
            pointer-events: none;
            z-index: 20;
        }
        .particle {
            position: absolute;
            border-radius: 50%;
            animation:
                float var(--particle-duration, 120s) linear infinite,
                pulse var(--pulse-duration, 8s) ease-in-out infinite;
            transform-origin: 50vw 50vh;
        }
        @keyframes float {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @keyframes pulse {
            0%, 100% { opacity: 0.15; scale: 0.9; }
            50% { opacity: 0.4; scale: 1.1; }
        }
    </style>
    {{ block "head" . }}{{ end }}
</head>
<body class="bg-black text-gray-100 flex flex-col min-h-screen">
    <div class="gradient-overlay"></div>
    <div class="particles" id="particles"></div>
    <script>
        (function() {
            const container = document.getElementById('particles');
            const baseSize = 1920 * 1080;
            function calcDuration() {
                const currentSize = window.innerWidth * window.innerHeight;
                const ratio = Math.sqrt(currentSize / baseSize);
                return Math.max(20, Math.min(80, 80 * ratio));
            }
            function updateParticleDuration() {
                const duration = calcDuration();
                document.documentElement.style.setProperty('--particle-duration', duration + 's');
            }
            updateParticleDuration();
            window.addEventListener('resize', updateParticleDuration);
            const colors = {
                h: ['#7c6cae', '#8b7cb8', '#6a5a9e', '#9b8bc8', '#5d4d8e'],
                e: ['#e8a0b0', '#f0b0c0', '#dca0b0', '#f5c0d0', '#d890a0']
            };
            const count = 15;
            const initialDuration = calcDuration();
            for (let i = 0; i < count; i++) {
                const el = document.createElement('div');
                el.className = 'particle';
                const isH = Math.random() > 0.5;
                const colorArr = isH ? colors.h : colors.e;
                const color = colorArr[Math.floor(Math.random() * colorArr.length)];
                const size = 60 + Math.random() * 150;
                el.style.width = size + 'px';
                el.style.height = size + 'px';
                el.style.left = (20 + Math.random() * 60) + '%';
                el.style.top = (20 + Math.random() * 60) + '%';
                el.style.background = 'radial-gradient(circle, ' + color + ' 0%, transparent 70%)';
                el.style.setProperty('--pulse-duration', (5 + Math.random() * 10) + 's');
                el.style.animationDelay = -Math.random() * initialDuration + 's, ' + -Math.random() * 15 + 's';
                el.style.animationDirection = Math.random() > 0.5 ? 'normal' : 'reverse';
                container.appendChild(el);
            }
        })();
    </script>
    {{ block "header" . }}{{ partial "header.html" . }}{{ end }}
    <main class="flex-grow flex flex-col relative z-10">
        {{ block "main" . }}{{ end }}
    </main>
    {{ block "footer" . }}{{ partial "footer.html" . }}{{ end }}
</body>
</html>
